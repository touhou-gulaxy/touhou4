namespace = spth_precursor

# triggered on_survey_planet
# this = ship
# root = ship
# from = planet
ship_event = {
    id = spth_precursor.100
    title = spth_precursor.100.name
    desc = spth_precursor.100.desc
    picture = GFX_evt_touhou_makai_bg
    event_chain = touhou_makai_chain
    location = from
    is_triggered_only = yes
    trigger = {
        solar_system = {
            NOT = { is_same_value = root.owner.capital_scope.solar_system }
        }
        owner = {
            is_ai = no
            spth_has_precursor_intro = no
            has_authority = auth_gensokyo
        }
        from = {
            has_anomaly = no
            is_star = no
        }
    }
    weight_multiplier = {
        factor = 1
        modifier = {
            NOT = { owner = { has_authority = auth_gensokyo } }
            mult = 0
        }
        modifier = {
            owner = { has_relic = r_th_latency }
            mult = 4
        }
    }
    immediate = {
        owner = {
            set_country_flag = touhou_makai_intro
            begin_event_chain = {
                event_chain = touhou_makai_chain
                target = root
            }
            create_point_of_interest = {
                id = touhou_makai_chain_poi.1
                name = touhou_makai_chain_poi.1
                desc = touhou_makai_chain_poi.1.desc
                event_chain = touhou_makai_chain
                location = root.from
            }
        }
    }
    option = {
        name = spth_precursor.100.a
        owner = {
            tooltip = {
                begin_event_chain = {
                    event_chain = "touhou_makai_chain"
                    target = root
                }
            }
            if = {
                limit = { has_ancrel = yes }
                small_artifact_reward = yes
            }
        }
    }
    option = {
        name = spth_precursor.100.b
        owner = {
            tooltip = {
                begin_event_chain = {
                    event_chain = "touhou_makai_chain"
                    target = root
                }
            }
            if = {
                limit = { has_ancrel = yes }
                small_artifact_reward = yes
            }
        }
    }
    after = {
        hidden_effect = {
            owner = {
                country_event = {
                    id = spth_precursor.101
                    days = 60
                    random = 30
                    scopes = { from = root.from }
                }
            }
        }
    }
}
country_event = {
    id = spth_precursor.101
    title = spth_precursor.101.name
    desc = spth_precursor.101.desc
    event_chain = touhou_makai_chain
    picture = GFX_evt_spth_nebula_stars
    location = from.star
    is_triggered_only = yes
    option = {
        name = spth_precursor.101.a
        from = {
            solar_system = {
                spawn_astral_rift = {
                    in_place_of = prev
                    id = touhou_precursor_makai_intro
                    graphics_entity_name = astral_rift_6_entity
                    init_effect = {
                        set_variable = { which = spth_precursor_makai_rift_size value = 5 }
                        set_astral_rift_flag = spth_precursor_makai_rift
                        save_event_target_as = touhou_precursor_makai_intro_rift
                    }
                }
            }
            create_point_of_interest = {
                id = touhou_makai_chain_poi.2
                name = touhou_makai_chain_poi.2
                desc = touhou_makai_chain_poi.2.desc
                event_chain = touhou_makai_chain
                location = event_target:touhou_precursor_makai_intro_rift
            }
        }
    }
}
country_event = {
    id = spth_precursor.102
    title = spth_precursor.102.name
    desc = spth_precursor.102.desc
    picture = GFX_evt_touhou_makai_bg
    event_chain = touhou_makai_chain
    location = capital_scope
    is_triggered_only = yes
    option = {
        name = spth_precursor.102.a
        hidden_effect = {
            set_country_flag = can_unlock_spth_precursor_makai_locate
        }
        add_research_option = tech_spth_precursor_makai_locate
        add_tech_progress = {
            tech = tech_spth_precursor_makai_locate
            progress = 0.5
        }
    }
}
country_event = {
    id = spth_precursor.103
    title = spth_precursor.103.name
    desc = spth_precursor.103.desc
    picture = GFX_evt_kamikakushi
    event_chain = touhou_makai_chain
    location = from
    is_triggered_only = yes
    option = {
        name = spth_precursor.103.a
        enable_special_project = {
            name = spth_project_precursor_makai_arc_1
            owner = root
            location = from
        }
    }
}
country_event = {
    id = spth_precursor.104
    title = spth_precursor.104.name
    desc = spth_precursor.104.desc
    picture = GFX_evt_kamikakushi
    event_chain = touhou_makai_chain
    location = from
    is_triggered_only = yes
    immediate = {
        create_point_of_interest = {
            id = touhou_makai_chain_poi.3
            name = spth_precursor.104.name
            desc = spth_precursor.104.poi_desc
            event_chain = touhou_makai_chain
        }
    }
    option = {
        name = spth_precursor.104.a
        from = {
            create_archaeological_site = site_spth_precursor_makai_base
        }
    }
}
country_event = { inline_script = { script = events/spth_precursor_makai_config id = 105 picture = GFX_evt_dead_city poi = 4 } }
country_event = { inline_script = { script = events/spth_precursor_makai_config id = 106 picture = GFX_evt_space_station poi = 5 } }
country_event = { inline_script = { script = events/spth_precursor_makai_config id = 107 picture = GFX_evt_exploding_ship poi = 6 } }
country_event = { inline_script = { script = events/spth_precursor_makai_config id = 108 picture = GFX_evt_mysterious_signal poi = 7 } }
country_event = { inline_script = { script = events/spth_precursor_makai_config id = 109 picture = GFX_evt_spth_nebula poi = 8 } }
country_event = { inline_script = { script = events/spth_precursor_makai_config id = 110 picture = GFX_evt_astral_rift_research_lab poi = 9 } }

country_event = {
    id = spth_precursor.114
    title = spth_precursor.114.name
    desc = spth_precursor.114.desc
    picture = GFX_evt_hakurei_shrine_in_night
    event_chain = touhou_makai_chain
    location = capital_scope
    is_triggered_only = yes
    option = {
        name = spth_precursor.114.a
    }
    after = {
    }
}
