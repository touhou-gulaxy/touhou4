spth_story_lunar_capital_outpost = {
    class = sc_spth_lunar_outpost
    usage = misc_system_init
    name = NAME_spth_story_lunar_outpost_system
    max_instances = 1
    spawn_chance = 9999
    flags = {
        spth_story_crisis_home
        spth_story_crisis_outpost
        ag_no_jump_in_system
        spth_no_jump_in_system
        cannot_be_hit_by_aow_starfall_spear
        kuat_cannot_be_hit_by_starkillerbase
        ag_no_star_killer_target_system
    }
    planet = {
        class = pc_spiritual_power_star
        orbit_distance = 0
        orbit_angle = 0
        size = 50
        init_effect = { prevent_anomaly = yes }
    }
    planet = {
        name = NAME_spth_story_lunar_outpost_planet
        class = "pc_gensokyo_planet"
        orbit_distance = 0
        orbit_angle = 0
        size = 50
        has_ring = no
        flags = { spth_story_crisis_outpost_base }
        init_effect = {
            prevent_anomaly = yes
            create_species = {
                name = NAME_spth_lunar_capital_sp
                class = "THSC"
                can_generate_leaders = yes
                portrait = touhou2
                pops_can_reproduce = yes
                name_list = touhouchs
                traits = {
                    trait = trait_touhou
                    trait = trait_spth_moon_human
                    trait = trait_spth_moon_rabbit
                }
                extra_trait_points = 4
                gender = female
                immortal = yes
                effect = {
                    save_global_event_target_as = spth_lunar_capital_species
                }
            }
            # 创建国家
            create_country = {
                name = NAME_spth_story_lunar_outpost
                species = event_target:spth_lunar_capital_species
                name_list = touhouchs
                type = spth_fallen_empire
                flag = {
                    icon = {
                        category = "touhousp"
                        file = "lunar_capital_alt.dds"
                    }
                    background = {
                        category = "backgrounds"
                        file = "00_solid.dds"
                    }
                    colors = {
                        "white"
                        "white"
                        "white"
                        "null"
                    }
                }
                ignore_initial_colony_error = yes
                authority = auth_gensokyo
                civics = {
                    civic = civic_lethargic_leadership_lunar
                    civic = civic_empire_in_decline_lunar
                }
                origin = "origin_lunar_capital"
                ethos = { ethic = ethic_fanatic_spiritualist ethic = ethic_militarist }
                effect = {
                    add_global_ship_design = "NAME_Cleanser"
                    add_global_ship_design = "NAME_Eternal"
                    add_global_ship_design = "NAME_Avatar"
                    add_global_ship_design = "NAME_Zealot"
                    add_global_ship_design = "NAME_Penitent"
                    add_global_ship_design = "NAME_Faith"
                    add_global_ship_design = "NAME_Pilgrim"
                    add_global_ship_design = "NAME_FE_Starbase"
                    save_global_event_target_as = spth_story_lunar_outpost_country
                    set_country_flag = protected_from_queen_storm
                    set_country_flag = spth_story_lunar_outpost
                    set_country_flag = touhou_mod_country
                    set_graphical_culture = strg_01
                    add_modifier = { modifier = spth_lunar_capital days = -1 }
                    add_resource = {
                        minerals = 1000000
                        energy = 1000000
                        food = 1000000
                        influence = 1000000
                        alloys = 1000000
                        consumer_goods = 1000000
                        sr_dark_matter = 1000000
                        sr_living_metal = 100000
                        sr_zro = 1000000
                        sr_fuka = 1000000
                        sr_lingli = 1000000
                    }
                }
            }
            set_owner = event_target:spth_story_lunar_outpost_country
            add_building = building_spth_planet_shirne
            add_building = building_spth_housing
            add_building = building_spth_housing
            add_building = building_spth_lunar_databank
            add_building = building_spth_research_base_2
            add_building = building_spth_research_base_1
            add_building = building_spth_common_foundry
            add_building = building_spth_common_factory
            add_building = building_fe_administration_2
            add_building = building_dimensional_fabricator
            while = { count = 25 create_pop_group = { species = owner_main_species } }
            while = { count = 10 add_district = district_spth_sp_produce }
            while = { count = 5 add_district = district_gensokyo_mosen }
            while = { count = 5 add_district = district_gensokyo_yaoguai }
            while = { count = 5 add_district = district_gensokyo_kyuuto }
            while = { count = 5 add_district = district_gensokyo_misty_lake }
            while = { count = 5 add_district = district_gensokyo_genbu_ravine }
        }
    }
    asteroid_belt = {
        type = rocky_asteroid_belt
        radius = 300
    }
    change_orbit = 300
    planet = {
        name = NAME_spth_story_asteroid_0
        class = "pc_asteroid"
        orbit_distance = 60
        orbit_angle = 0
        size = 6
        has_ring = no
        init_effect = {
            set_planet_flag = spth_story_crisis_outpost_defence_fleet
            add_deposit = d_minerals_10
            random_list = {
                10 = { add_deposit = d_minerals_1 }
                10 = { add_deposit = d_minerals_3 }
                10 = { add_deposit = d_minerals_5 }
                10 = { add_deposit = d_minerals_7 }
                5 = { add_deposit = d_minerals_9 }
                5 = { add_deposit = d_minerals_10 }
            }
        }
    }
    planet = {
        name = NAME_spth_story_asteroid_1
        class = "pc_rare_crystal_asteroid"
        orbit_distance = 60
        orbit_angle = 120
        size = 6
        has_ring = no
        init_effect = {
            set_planet_flag = spth_story_crisis_outpost_defence_fleet
            add_deposit = d_energy_10
            random_list = {
                10 = { add_deposit = d_energy_1 }
                10 = { add_deposit = d_energy_3 }
                10 = { add_deposit = d_energy_5 }
                10 = { add_deposit = d_energy_7 }
                5 = { add_deposit = d_energy_9 }
                5 = { add_deposit = d_energy_10 }
            }
        }
    }
    planet = {
        name = NAME_spth_story_asteroid_2
        class = "pc_crystal_asteroid"
        orbit_distance = 60
        orbit_angle = 120
        size = 6
        has_ring = no
        init_effect = {
            set_planet_flag = spth_story_crisis_outpost_defence_fleet
            add_deposit = d_dark_matter_deposit_10
            random_list = {
                10 = { add_deposit = d_dark_matter_deposit_1 }
                10 = { add_deposit = d_dark_matter_deposit_2 }
                10 = { add_deposit = d_dark_matter_deposit_3 }
                10 = { add_deposit = d_dark_matter_deposit_10 }
            }
        }
    }
    init_effect = {
        save_global_event_target_as = spth_story_lunar_outpost
        create_starbase = {
            size = "starbase_citadel"
            owner = event_target:spth_story_lunar_outpost_country
            module = "shipyard"
            module = "gun_battery"
            module = "gun_battery"
            module = "gun_battery"
            module = "gun_battery"
            module = "gun_battery"
            building = "toho_yards"
            building = "toho_yards"
            building = "colossus_yards"
            building = "titan_yards"
        }
        spth_story_lunar_outpost_home_fleets = yes
    }
}
spth_story_lunar_minigalaxynary_rim_1 = {
    class = sc_spth_minigalaxynary
    usage = misc_system_init
    name = NAME_spth_story_lunar_outpost_rim_1
    max_instances = 1
    spawn_chance = 9999
    flags = {
        spth_story_crisis_outpost
        ag_no_jump_in_system
        spth_no_jump_in_system
        cannot_be_hit_by_aow_starfall_spear
        kuat_cannot_be_hit_by_starkillerbase
        ag_no_star_killer_target_system
    }
    asteroid_belt = {
        type = rocky_asteroid_belt
        radius = 75
    }
    planet = {
        class = pc_a_star
        name = "NAME_spth_story_lunar_planet_a"
        orbit_distance = 0
        orbit_angle = 0
        size = 25

        planet = {
            class = pc_gas_giant
            size = 15
            orbit_distance = 25
            orbit_angle = random

            moon = {
                class = "rl_no_atmosphere_planets"
                size = { min = 6 max = 25 }
                orbit_distance = 10
                init_effect = {
                    add_modifier = {
                        modifier = "terraforming_candidate"
                        days = -1
                    }
                }
            }
        }

        planet = {
            class = pc_gaia
            orbit_angle = 160
            orbit_distance = 20
            size = { min = 20 max = 25 }
            has_ring = no
            modifiers = none
            deposit_blockers = none

            moon = {
                class = "rl_habitable_normal"
                size = { min = 6 max = 25 }
                orbit_distance = 15
            }
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_b"
        size = 20
        orbit_distance = 210
        orbit_angle = random

        planet = {
            class = "rl_habitable_normal"
            size = { min = 6 max = 25 }
            orbit_distance = 30
            orbit_angle = random
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_c"
        size = 40
        orbit_distance = -30
        orbit_angle = 120

        planet = {
            class = pc_gas_giant
            size = 30
            orbit_distance = 60

            moon = {
                class = "rl_no_atmosphere_planets"
                size = { min = 6 max = 25 }
                orbit_distance = 20
                init_effect = {
                    add_modifier = {
                        modifier = "terraforming_candidate"
                        days = -1
                    }
                }
            }
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_d"
        size = 36
        orbit_distance = 0
        orbit_angle = 90

        planet = {
            class = "rl_habitable_normal"
            orbit_distance = 60
            size = { min = 6 max = 25 }
            orbit_angle = 45
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_e"
        size = 24
        orbit_distance = 40
        orbit_angle = 200

        planet = {
            class = pc_gas_giant
            size = 34
            orbit_distance = 40

        }

        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_angle = random
            orbit_distance = 30
            init_effect = {
                add_modifier = {
                    modifier = "terraforming_candidate"
                    days = -1
                }
            }
        }

        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_angle = random
            orbit_distance = 30

            moon = {
                class = "rl_no_atmosphere_planets"
                size = { min = 6 max = 25 }
                orbit_distance = 10
            }
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_f"
        size = 28
        orbit_distance = 20
        orbit_angle = 120

        planet = {
            class = "rl_habitable_normal"
            size = { min = 6 max = 25 }
            orbit_distance = 30
            orbit_angle = random
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_g"
        size = 20
        orbit_distance = 20
        orbit_angle = 120

        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 30
            orbit_angle = random
        }
        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 25
            orbit_angle = random
            init_effect = {
                add_modifier = {
                    modifier = "terraforming_candidate"
                    days = -1
                }
            }
        }
        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 20
            orbit_angle = random
        }
        planet = {
            class = pc_gas_giant
            size = 36
            orbit_distance = 25
            orbit_angle = random
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_h"
        size = 30
        orbit_distance = 60
        orbit_angle = 170

        planet = {
            class = "rl_habitable_normal"
            size = { min = 6 max = 25 }
            orbit_distance = 25
            orbit_angle = random
            modifiers = none
        }
        planet = {
            class = pc_gas_giant
            size = 40
            orbit_distance = 25
            orbit_angle = random
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_i"
        size = 20
        orbit_distance = 30
        orbit_angle = 50

        planet = {
            class = "rl_habitable_normal"
            size = { min = 6 max = 25 }
            orbit_distance = 40
            orbit_angle = random

            moon = {
                class = "rl_no_atmosphere_planets"
                size = { min = 6 max = 25 }
                orbit_distance = 15
                init_effect = {
                    add_modifier = {
                        modifier = "terraforming_candidate"
                        days = -1
                    }
                }
            }
        }
        planet = {
            class = pc_gas_giant
            size = 32
            orbit_distance = 40
            orbit_angle = random

            moon = {
                class = "rl_no_atmosphere_planets"
                size = { min = 6 max = 25 }
                orbit_distance = 25
            }
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_j"
        size = 30
        orbit_distance = 10
        orbit_angle = 40

        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 25
            orbit_angle = random
            modifiers = none
            init_effect = {
                add_modifier = {
                    modifier = "terraforming_candidate"
                    days = -1
                }
            }
        }
        planet = {
            class = pc_gas_giant
            size = 34
            orbit_distance = 25
            orbit_angle = random
        }
        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 30
            orbit_angle = random
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_k"
        size = 20
        orbit_distance = -60
        orbit_angle = 50

        planet = {
            class = pc_gas_giant
            size = 18
            orbit_distance = 30

            moon = {
                class = "rl_no_atmosphere_planets"
                size = { min = 6 max = 25 }
                orbit_distance = 15
                init_effect = {
                    add_modifier = {
                        modifier = "terraforming_candidate"
                        days = -1
                    }
                }
            }
        }
        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 35
            orbit_angle = random
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_l"
        size = 30
        orbit_distance = 30
        orbit_angle = 100

        planet = {
            class = "rl_habitable_normal"
            size = { min = 6 max = 25 }
            orbit_distance = 50
            orbit_angle = 60
            modifiers = none
        }
        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 20
            orbit_angle = 60
            modifiers = none
        }
    }
    init_effect = {
        save_global_event_target_as = spth_story_lunar_outpost_last
        create_starbase = {
            size = "starbase_citadel"
            owner = event_target:spth_story_lunar_outpost_country
            module = "shipyard"
            module = "gun_battery"
            module = "gun_battery"
            module = "gun_battery"
            module = "gun_battery"
            module = "gun_battery"
            building = "toho_yards"
            building = "toho_yards"
            building = "colossus_yards"
            building = "titan_yards"
        }
    }
}
spth_story_lunar_minigalaxynary_rim_2 = {
    class = sc_spth_minigalaxynary
    usage = misc_system_init
    name = NAME_spth_story_lunar_outpost_rim_2
    max_instances = 1
    spawn_chance = 9999
    flags = {
        spth_story_crisis_outpost
        ag_no_jump_in_system
        spth_no_jump_in_system
        cannot_be_hit_by_aow_starfall_spear
        kuat_cannot_be_hit_by_starkillerbase
        ag_no_star_killer_target_system
    }
    asteroid_belt = {
        type = rocky_asteroid_belt
        radius = 75
    }
    planet = {
        class = pc_a_star
        name = "NAME_spth_story_lunar_planet_a_1"
        orbit_distance = 0
        orbit_angle = 0
        size = 25

        planet = {
            class = pc_gas_giant
            size = 15
            orbit_distance = 25
            orbit_angle = random

            moon = {
                class = "rl_no_atmosphere_planets"
                size = { min = 6 max = 25 }
                orbit_distance = 10
                init_effect = {
                    add_modifier = {
                        modifier = "terraforming_candidate"
                        days = -1
                    }
                }
            }
        }

        planet = {
            class = pc_gaia
            orbit_angle = 160
            orbit_distance = 20
            size = { min = 20 max = 25 }
            has_ring = no
            modifiers = none
            deposit_blockers = none

            moon = {
                class = "rl_habitable_normal"
                size = { min = 6 max = 25 }
                orbit_distance = 15
            }
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_b_1"
        size = 20
        orbit_distance = 210
        orbit_angle = random

        planet = {
            class = "rl_habitable_normal"
            size = { min = 6 max = 25 }
            orbit_distance = 30
            orbit_angle = random
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_c_1"
        size = 40
        orbit_distance = -30
        orbit_angle = 120

        planet = {
            class = pc_gas_giant
            size = 30
            orbit_distance = 60

            moon = {
                class = "rl_no_atmosphere_planets"
                size = { min = 6 max = 25 }
                orbit_distance = 20
                init_effect = {
                    add_modifier = {
                        modifier = "terraforming_candidate"
                        days = -1
                    }
                }
            }
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_d_1"
        size = 36
        orbit_distance = 0
        orbit_angle = 90

        planet = {
            class = "rl_habitable_normal"
            orbit_distance = 60
            size = { min = 6 max = 25 }
            orbit_angle = 45
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_e_1"
        size = 24
        orbit_distance = 40
        orbit_angle = 200

        planet = {
            class = pc_gas_giant
            size = 34
            orbit_distance = 40

        }

        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_angle = random
            orbit_distance = 30
            init_effect = {
                add_modifier = {
                    modifier = "terraforming_candidate"
                    days = -1
                }
            }
        }

        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_angle = random
            orbit_distance = 30

            moon = {
                class = "rl_no_atmosphere_planets"
                size = { min = 6 max = 25 }
                orbit_distance = 10
            }
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_f_1"
        size = 28
        orbit_distance = 20
        orbit_angle = 120

        planet = {
            class = "rl_habitable_normal"
            size = { min = 6 max = 25 }
            orbit_distance = 30
            orbit_angle = random
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_g_1"
        size = 20
        orbit_distance = 20
        orbit_angle = 120

        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 30
            orbit_angle = random
        }
        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 25
            orbit_angle = random
            init_effect = {
                add_modifier = {
                    modifier = "terraforming_candidate"
                    days = -1
                }
            }
        }
        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 20
            orbit_angle = random
        }
        planet = {
            class = pc_gas_giant
            size = 36
            orbit_distance = 25
            orbit_angle = random
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_h_1"
        size = 30
        orbit_distance = 60
        orbit_angle = 170

        planet = {
            class = "rl_habitable_normal"
            size = { min = 6 max = 25 }
            orbit_distance = 25
            orbit_angle = random
            modifiers = none
        }
        planet = {
            class = pc_gas_giant
            size = 40
            orbit_distance = 25
            orbit_angle = random
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_i_1"
        size = 20
        orbit_distance = 30
        orbit_angle = 50

        planet = {
            class = "rl_habitable_normal"
            size = { min = 6 max = 25 }
            orbit_distance = 40
            orbit_angle = random

            moon = {
                class = "rl_no_atmosphere_planets"
                size = { min = 6 max = 25 }
                orbit_distance = 15
                init_effect = {
                    add_modifier = {
                        modifier = "terraforming_candidate"
                        days = -1
                    }
                }
            }
        }
        planet = {
            class = pc_gas_giant
            size = 32
            orbit_distance = 40
            orbit_angle = random

            moon = {
                class = "rl_no_atmosphere_planets"
                size = { min = 6 max = 25 }
                orbit_distance = 25
            }
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_j_1"
        size = 30
        orbit_distance = 10
        orbit_angle = 40

        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 25
            orbit_angle = random
            modifiers = none
            init_effect = {
                add_modifier = {
                    modifier = "terraforming_candidate"
                    days = -1
                }
            }
        }
        planet = {
            class = pc_gas_giant
            size = 34
            orbit_distance = 25
            orbit_angle = random
        }
        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 30
            orbit_angle = random
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_k_1"
        size = 20
        orbit_distance = -60
        orbit_angle = 50

        planet = {
            class = pc_gas_giant
            size = 18
            orbit_distance = 30

            moon = {
                class = "rl_no_atmosphere_planets"
                size = { min = 6 max = 25 }
                orbit_distance = 15
                init_effect = {
                    add_modifier = {
                        modifier = "terraforming_candidate"
                        days = -1
                    }
                }
            }
        }
        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 35
            orbit_angle = random
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_l_1"
        size = 30
        orbit_distance = 30
        orbit_angle = 100

        planet = {
            class = "rl_habitable_normal"
            size = { min = 6 max = 25 }
            orbit_distance = 50
            orbit_angle = 60
            modifiers = none
        }
        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 20
            orbit_angle = 60
            modifiers = none
        }
    }
    init_effect = {
        save_global_event_target_as = spth_story_lunar_outpost_forever
        create_starbase = {
            size = "starbase_citadel"
            owner = event_target:spth_story_lunar_outpost_country
            module = "shipyard"
            module = "gun_battery"
            module = "gun_battery"
            module = "gun_battery"
            module = "gun_battery"
            module = "gun_battery"
            building = "toho_yards"
            building = "toho_yards"
            building = "colossus_yards"
            building = "titan_yards"
        }
    }
}
spth_story_lunar_minigalaxynary_rim_3 = {
    class = sc_spth_minigalaxynary
    usage = misc_system_init
    name = NAME_spth_story_lunar_outpost_rim_3
    max_instances = 1
    spawn_chance = 9999
    flags = {
        spth_story_crisis_outpost
        ag_no_jump_in_system
        spth_no_jump_in_system
        cannot_be_hit_by_aow_starfall_spear
        kuat_cannot_be_hit_by_starkillerbase
        ag_no_star_killer_target_system
    }
    asteroid_belt = {
        type = rocky_asteroid_belt
        radius = 75
    }
    planet = {
        class = pc_a_star
        name = "NAME_spth_story_lunar_planet_a_2"
        orbit_distance = 0
        orbit_angle = 0
        size = 25

        planet = {
            class = pc_gas_giant
            size = 15
            orbit_distance = 25
            orbit_angle = random

            moon = {
                class = "rl_no_atmosphere_planets"
                size = { min = 6 max = 25 }
                orbit_distance = 10
                init_effect = {
                    add_modifier = {
                        modifier = "terraforming_candidate"
                        days = -1
                    }
                }
            }
        }

        planet = {
            class = pc_gaia
            orbit_angle = 160
            orbit_distance = 20
            size = { min = 20 max = 25 }
            has_ring = no
            modifiers = none
            deposit_blockers = none

            moon = {
                class = "rl_habitable_normal"
                size = { min = 6 max = 25 }
                orbit_distance = 15
            }
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_b_2"
        size = 20
        orbit_distance = 210
        orbit_angle = random

        planet = {
            class = "rl_habitable_normal"
            size = { min = 6 max = 25 }
            orbit_distance = 30
            orbit_angle = random
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_c_2"
        size = 40
        orbit_distance = -30
        orbit_angle = 120

        planet = {
            class = pc_gas_giant
            size = 30
            orbit_distance = 60

            moon = {
                class = "rl_no_atmosphere_planets"
                size = { min = 6 max = 25 }
                orbit_distance = 20
                init_effect = {
                    add_modifier = {
                        modifier = "terraforming_candidate"
                        days = -1
                    }
                }
            }
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_d_2"
        size = 36
        orbit_distance = 0
        orbit_angle = 90

        planet = {
            class = "rl_habitable_normal"
            orbit_distance = 60
            size = { min = 6 max = 25 }
            orbit_angle = 45
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_e_2"
        size = 24
        orbit_distance = 40
        orbit_angle = 200

        planet = {
            class = pc_gas_giant
            size = 34
            orbit_distance = 40

        }

        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_angle = random
            orbit_distance = 30
            init_effect = {
                add_modifier = {
                    modifier = "terraforming_candidate"
                    days = -1
                }
            }
        }

        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_angle = random
            orbit_distance = 30

            moon = {
                class = "rl_no_atmosphere_planets"
                size = { min = 6 max = 25 }
                orbit_distance = 10
            }
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_f_2"
        size = 28
        orbit_distance = 20
        orbit_angle = 120

        planet = {
            class = "rl_habitable_normal"
            size = { min = 6 max = 25 }
            orbit_distance = 30
            orbit_angle = random
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_g_2"
        size = 20
        orbit_distance = 20
        orbit_angle = 120

        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 30
            orbit_angle = random
        }
        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 25
            orbit_angle = random
            init_effect = {
                add_modifier = {
                    modifier = "terraforming_candidate"
                    days = -1
                }
            }
        }
        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 20
            orbit_angle = random
        }
        planet = {
            class = pc_gas_giant
            size = 36
            orbit_distance = 25
            orbit_angle = random
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_h_2"
        size = 30
        orbit_distance = 60
        orbit_angle = 170

        planet = {
            class = "rl_habitable_normal"
            size = { min = 6 max = 25 }
            orbit_distance = 25
            orbit_angle = random
            modifiers = none
        }
        planet = {
            class = pc_gas_giant
            size = 40
            orbit_distance = 25
            orbit_angle = random
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_i_2"
        size = 20
        orbit_distance = 30
        orbit_angle = 50

        planet = {
            class = "rl_habitable_normal"
            size = { min = 6 max = 25 }
            orbit_distance = 40
            orbit_angle = random

            moon = {
                class = "rl_no_atmosphere_planets"
                size = { min = 6 max = 25 }
                orbit_distance = 15
                init_effect = {
                    add_modifier = {
                        modifier = "terraforming_candidate"
                        days = -1
                    }
                }
            }
        }
        planet = {
            class = pc_gas_giant
            size = 32
            orbit_distance = 40
            orbit_angle = random

            moon = {
                class = "rl_no_atmosphere_planets"
                size = { min = 6 max = 25 }
                orbit_distance = 25
            }
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_j_2"
        size = 30
        orbit_distance = 10
        orbit_angle = 40

        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 25
            orbit_angle = random
            modifiers = none
            init_effect = {
                add_modifier = {
                    modifier = "terraforming_candidate"
                    days = -1
                }
            }
        }
        planet = {
            class = pc_gas_giant
            size = 34
            orbit_distance = 25
            orbit_angle = random
        }
        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 30
            orbit_angle = random
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_k_2"
        size = 20
        orbit_distance = -60
        orbit_angle = 50

        planet = {
            class = pc_gas_giant
            size = 18
            orbit_distance = 30

            moon = {
                class = "rl_no_atmosphere_planets"
                size = { min = 6 max = 25 }
                orbit_distance = 15
                init_effect = {
                    add_modifier = {
                        modifier = "terraforming_candidate"
                        days = -1
                    }
                }
            }
        }
        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 35
            orbit_angle = random
        }
    }
    planet = {
        class = star
        name = "NAME_spth_story_lunar_planet_l_2"
        size = 30
        orbit_distance = 30
        orbit_angle = 100

        planet = {
            class = "rl_habitable_normal"
            size = { min = 6 max = 25 }
            orbit_distance = 50
            orbit_angle = 60
            modifiers = none
        }
        planet = {
            class = "rl_no_atmosphere_planets"
            size = { min = 6 max = 25 }
            orbit_distance = 20
            orbit_angle = 60
            modifiers = none
        }
    }
    init_effect = {
        save_global_event_target_as = spth_story_lunar_outpost_dream
        create_starbase = {
            size = "starbase_citadel"
            owner = event_target:spth_story_lunar_outpost_country
            module = "shipyard"
            module = "gun_battery"
            module = "gun_battery"
            module = "gun_battery"
            module = "gun_battery"
            module = "gun_battery"
            building = "toho_yards"
            building = "toho_yards"
            building = "colossus_yards"
            building = "titan_yards"
        }
    }
}

spth_story_lunar_outpost_portal = {
    class = sc_spth_lunar_shrine
    usage = misc_system_init
    name = NAME_spth_lunar_outpost_shrine
    max_instances = 1
    spawn_chance = 9999
    flags = {
        spth_story_crisis_outpost
        ag_no_jump_in_system
        spth_no_jump_in_system
        cannot_be_hit_by_aow_starfall_spear
        kuat_cannot_be_hit_by_starkillerbase
        ag_no_star_killer_target_system
        spth_lunar_portal_endpoint
    }
    planet = {
        class = pc_rift_star
        size = 1
        orbit_distance = 0
        init_effect = { prevent_anomaly = yes set_planet_entity = { entity = spth_empty_planet } }
    }
    init_effect = {
        save_global_event_target_as = spth_story_lunar_outpost_portal
        create_starbase = {
            size = "starbase_citadel"
            owner = event_target:spth_story_lunar_outpost_country
            module = "shipyard"
            module = "gun_battery"
            module = "gun_battery"
            module = "gun_battery"
            module = "gun_battery"
            module = "gun_battery"
            building = "toho_yards"
            building = "toho_yards"
            building = "colossus_yards"
            building = "titan_yards"
        }
        spawn_megastructure = {
            type = spth_lunar_outpost_portal
            owner = event_target:spth_story_lunar_outpost_country
            coords_from = star
            orbit_distance = 0
            orbit_angle = 0
        }
    }
}

spth_story_lunar_capital_union_system = {
    class = "sc_pulsar"
    name = spth_lunar_union_system
    prevent_anomalies = yes
    usage = misc_system_init
    usage_odds = 0
    flags = {
        cannot_be_hit_by_aow_starfall_spear
        kuat_cannot_be_hit_by_starkillerbase
        ag_no_star_killer_target_system
        spth_system
        spth_no_jump_in_system
        ag_no_jump_in_system
        spth_story_lunar_capital_union_system
    }
    planet = {
        count = 1
        class = pc_pulsar
        orbit_distance = 0
        orbit_angle = 1
        size = { min = 20 max = 30 }
        has_ring = no
        flags = { spth_story_lunar_capital_union_system_star }
        init_effect = {
            prevent_anomaly = yes
            while = {
                count = 25
                create_ambient_object = {
                    type = "small_debris_object"
                    entity_offset_height = { min = -0 max = -25 }
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = prev
                        distance = 45
                        angle = random
                    }
                }
            }
        }
    }

    change_orbit = 100

    planet = {
        class = pc_shielded
        orbit_distance = 20
        orbit_angle = { min = 90 max = 270 }
        size = 25
        change_orbit = @base_moon_distance
        init_effect = { prevent_anomaly = yes }
        flags = { spth_story_lunar_capital_union_system_arc }
        moon = {
            class = pc_shattered
            size = 10
            flags = { spth_story_lunar_capital_union_system_moon }
            init_effect = { prevent_anomaly = yes }
        }
    }
    init_effect = {
        create_ambient_object = {
            type = spth_lunar_union_gateway_disabled
            location = star
            entity_offset = { min = 160 max = 240 }
            entity_offset_angle = { min = 0 max = 180 }
            use_3d_location = yes
            entity_offset_height = { min = -30 max = -30 }
        }
        save_global_event_target_as = spth_story_lunar_capital_union_system
    }
}
spth_story_lunar_capital_aethon = {
    class = "sc_m_giant"
    name = spth_lunar_aethon
    prevent_anomalies = yes
    usage = misc_system_init
    usage_odds = 0
    flags = {
        cannot_be_hit_by_aow_starfall_spear
        kuat_cannot_be_hit_by_starkillerbase
        ag_no_star_killer_target_system
        spth_system
        spth_no_jump_in_system
        ag_no_jump_in_system
        spth_story_lunar_capital_aethon
    }
    planet = {
        count = 1
        class = pc_m_giant_star
        name = spth_lunar_aethon_star
        orbit_distance = 0
        orbit_angle = 1
        size = 30
        has_ring = no
        flags = { spth_story_lunar_capital_aethon_star }
        init_effect = {
            prevent_anomaly = yes
            create_ambient_object = {
                type = "abandoned_starbase_01_object"
            }
            while = {
                count = 25
                create_ambient_object = {
                    type = "small_debris_object"
                    entity_offset_height = { min = -0 max = -25 }
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = prev
                        distance = 50
                        angle = random
                    }
                }
            }
            while = {
                count = 15
                create_ambient_object = {
                    type = "small_debris_object"
                    entity_offset_height = { min = -0 max = -25 }
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = prev
                        distance = 75
                        angle = random
                    }
                }
            }
            while = {
                count = 10
                create_ambient_object = {
                    type = "large_debris_object"
                    entity_offset_height = { min = -0 max = -25 }
                    location = this
                }
                last_created_ambient_object = {
                    set_location = {
                        target = prev
                        distance = 100
                        angle = random
                    }
                }
            }
        }
    }
    asteroid_belt = { type = debris_asteroid_belt radius = 32 }
    change_orbit = 45
    planet = {
        name = "spth_lunar_aethon_ring_section"
        class = "pc_ringworld_tech"
        orbit_angle = 30
        orbit_distance = 0
        flags = { lunar_ring_struct_1 megastructure lunar_rw_section_0 }
    }
    planet = {
        name = "spth_lunar_aethon_ring_section"
        class = "pc_ringworld_tech"
        orbit_angle = 30
        orbit_distance = 0
        flags = { lunar_ring_struct_2 megastructure lunar_rw_section_0 }
    }
    # 宜居
    planet = {
        name = "spth_lunar_aethon_ring_colony"
        class = "pc_ringworld_th"
        size = 10
        orbit_angle = 30
        orbit_distance = 0
        flags = { lunar_ring_struct_3 megastructure lunar_rw_section_0 lunar_aethon_event_rw }
        init_effect = { while = { count = 8 add_deposit = d_lunar_aethon_ruin } }
    }
    planet = {
        name = "spth_lunar_aethon_ring_section"
        class = "pc_ringworld_tech"
        size = 8
        orbit_angle = 30
        orbit_distance = 0
        flags = { lunar_ring_struct_4 megastructure lunar_rw_section_1 }
    }
    planet = {
        name = "spth_lunar_aethon_ring_section"
        class = "pc_ringworld_tech"
        size = 8
        orbit_angle = 30
        orbit_distance = 0
        flags = { lunar_ring_struct_5 megastructure lunar_rw_section_1 }
    }
    planet = {
        name = "spth_lunar_aethon_ring_section"
        class = "pc_ringworld_tech"
        size = 8
        orbit_angle = 30
        orbit_distance = 0
        flags = { lunar_ring_struct_6 megastructure lunar_rw_section_1 }
    }
    planet = {
        name = "spth_lunar_aethon_ring_section"
        class = "pc_ringworld_tech"
        orbit_angle = 30
        orbit_distance = 0
        flags = { lunar_ring_struct_7 megastructure lunar_rw_section_2 }
    }
    planet = {
        name = "spth_lunar_aethon_ring_section"
        class = "pc_ringworld_tech"
        orbit_angle = 30
        orbit_distance = 0
        flags = { lunar_ring_struct_8 megastructure lunar_rw_section_2 }
    }
    planet = {
        name = "spth_lunar_aethon_ring_section"
        class = "pc_ringworld_seam_damaged"
        orbit_angle = 30
        orbit_distance = 0
        flags = { lunar_ring_struct_9 megastructure lunar_rw_section_2 }
    }
    planet = {
        name = "spth_lunar_aethon_ring_section"
        class = "pc_ringworld_seam_damaged"
        orbit_angle = 30
        orbit_distance = 0
        flags = { lunar_ring_struct_10 megastructure lunar_rw_section_3 }
    }
    planet = {
        name = "spth_lunar_aethon_ring_section"
        class = "pc_ringworld_seam_damaged"
        orbit_angle = 30
        orbit_distance = 0
        flags = { lunar_ring_struct_11 megastructure lunar_rw_section_3 }
    }
    planet = {
        name = "spth_lunar_aethon_ring_section"
        class = "pc_ringworld_seam_damaged"
        orbit_angle = 30
        orbit_distance = 0
        flags = { lunar_ring_struct_12 megastructure lunar_rw_section_3 }
    }
    change_orbit = 40
    planet = {
        name = "spth_lunar_aethon_planet_1"
        class = pc_kamikakushi_planet
        size = 20
        orbit_angle = 1
        orbit_distance = 0
        flags = { spth_story_lunar_capital_aethon_planet_1 }
        init_effect = {
            prevent_anomaly = yes
            save_global_event_target_as = spth_story_lunar_capital_aethon_planet_1
            add_deposit = d_lunar_aethon_obelisk
        }
    }
    asteroid_belt = { type = crystal_asteroid_belt radius = 100 }
    asteroid_belt = { type = icy_asteroid_belt radius = 120 }
    init_effect = {
        save_global_event_target_as = spth_story_lunar_capital_aethon
        spawn_megastructure = {
            type = spth_lunar_jumpdrive_gateway
            name = spth_lunar_jumpdrive_gateway_aethon
            coords_from = event_target:spth_story_lunar_capital_aethon_planet_1
            owner = event_target:spth_disappear_barrier_player
            orbit_distance = 0
            orbit_angle = 0
            graphical_culture = event_target:spth_disappear_barrier_player
            init_effect = {
                set_megastructure_flag = is_spth_lunar_jumpdrive_gateway
                set_megastructure_flag = spth_lunar_jumpdrive_gateway_aethon
            }
        }
    }
}
spth_story_lunar_capital_cluster34 = {
    class = "sc_spth_cluster34"
    name = spth_lunar_cluster34
    prevent_anomalies = yes
    usage = misc_system_init
    usage_odds = 0
    flags = {
        cannot_be_hit_by_aow_starfall_spear
        kuat_cannot_be_hit_by_starkillerbase
        ag_no_star_killer_target_system
        spth_system
        spth_no_jump_in_system
        ag_no_jump_in_system
        spth_story_lunar_capital_cluster34
    }
    planet = {
        count = 1
        class = pc_spth_void
        name = spth_lunar_cluster34_star
        orbit_distance = 0
        orbit_angle = 1
        size = 1
        has_ring = no
        flags = { spth_story_lunar_capital_aethon_star spth_main_star }
        init_effect = { prevent_anomaly = yes }
    }
    planet = {
        count = 1
        class = pc_a_star
        orbit_distance = 210
        orbit_angle = random
        size = 5
        has_ring = no
        flags = { spth_story_lunar_capital_aethon_star spth_sub_star }
        init_effect = { prevent_anomaly = yes }
        planet = { count = 2 class = pc_barren_cold size = { min = 6 max = 12 } orbit_distance = 40 orbit_angle = random }
        planet = { count = 1 class = pc_frozen size = { min = 8 max = 16 } orbit_distance = 30 }
    }
    planet = {
        count = 1
        class = pc_m_star
        orbit_distance = -40
        orbit_angle = random
        size = 20
        has_ring = no
        flags = { spth_story_lunar_capital_aethon_star spth_sub_star }
        init_effect = { prevent_anomaly = yes }
        planet = { count = 1 class = pc_gas_giant size = { min = 8 max = 16 } orbit_distance = 30 }
    }
    planet = {
        count = 1
        class = pc_b_star
        orbit_distance = 0
        orbit_angle = random
        size = 15
        has_ring = no
        flags = { spth_story_lunar_capital_aethon_star spth_sub_star }
        init_effect = { prevent_anomaly = yes }
        planet = { count = 3 class = pc_molten size = { min = 6 max = 12 } orbit_distance = 20 orbit_angle = random }
        planet = { count = 1 class = pc_desert size = { min = 8 max = 16 } orbit_distance = 25 }
    }
    planet = {
        count = 1
        class = pc_t_star
        orbit_distance = -20
        orbit_angle = random
        size = 12
        has_ring = no
        flags = { spth_story_lunar_capital_aethon_star spth_sub_star }
        init_effect = { prevent_anomaly = yes }
        planet = { count = 1 class = pc_nuked size = { min = 8 max = 16 } orbit_distance = 20 }
        planet = { count = 2 class = pc_ice_asteroid size = 10 orbit_distance = 25 orbit_angle = random }
    }
    planet = {
        count = 1
        class = pc_spiritual_power_star
        orbit_distance = -30
        orbit_angle = random
        size = 30
        has_ring = no
        flags = { spth_story_lunar_capital_aethon_star spth_sub_star }
        init_effect = { prevent_anomaly = yes }
        planet = { count = 2 class = pc_kamikakushi_planet size = { min = 20 max = 24 } orbit_distance = 48 orbit_angle = random }
    }
    planet = {
        count = 1
        class = pc_g_star
        orbit_distance = -10
        orbit_angle = random
        size = 26
        has_ring = no
        flags = { spth_story_lunar_capital_aethon_star spth_sub_star }
        init_effect = { prevent_anomaly = yes }
        planet = { count = 1 class = pc_molten size = 5 orbit_distance = 20 orbit_angle = random }
        planet = { count = 1 class = pc_barren size = 10 orbit_distance = 30 orbit_angle = random }
        planet = { count = 1 class = pc_broken size = 20 orbit_distance = 40 orbit_angle = random }
        planet = { count = 1 class = pc_gas_giant size = 30 orbit_distance = 50 orbit_angle = random }
        planet = { count = 1 class = pc_barren size = 16 orbit_distance = 60 orbit_angle = random }
    }
    init_effect = {
        spawn_megastructure = {
            type = spth_cluster34_installation
            coords_from = star
            owner = event_target:spth_disappear_barrier_player
            orbit_distance = 0
            orbit_angle = 0
            graphical_culture = event_target:spth_disappear_barrier_player
            init_effect = {
                set_megastructure_flag = is_spth_cluster34_installation
                set_megastructure_flag = spth_cluster34_installation_stage_1
            }
        }
        spawn_megastructure = {
            type = spth_lunar_jumpdrive_gateway
            coords_from = star
            owner = event_target:spth_disappear_barrier_player
            orbit_distance = 100
            orbit_angle = random
            graphical_culture = event_target:spth_disappear_barrier_player
            init_effect = {
                set_megastructure_flag = is_spth_lunar_jumpdrive_gateway
                set_megastructure_flag = spth_lunar_jumpdrive_gateway_cluster34
            }
        }
    }
}
