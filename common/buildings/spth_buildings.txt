building_spth_cloner = {
	base_buildtime = 360
	can_build = yes
	category = pop_assembly
	icon = building_artist_patron
	potential = {
		owner = {
			has_authority = auth_gensokyo
		}
		OR = {
			owner = { is_ai = no }
			AND = {
				owner = { is_ai = yes }
				num_buildings = {
					type = building_spth_cloner
					value < 1
				}
			}
		}
	}
	
	resources = {
		category = planet_buildings
		cost = {
			minerals = 600
		}
		cost = {
			trigger = {
				owner = { is_ai = no }
			}
			sr_lingli = 100
		}
		upkeep = {
			energy = 2
		}
	}

	triggered_planet_modifier = {
		custom_tooltip = building_spth_cloner_tooltip
		show_only_custom_tooltip = no
		modifier = {
			planet_barrier_capacity_use = 1
		}
	}
	
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_ai = no
				is_regular_empire = yes
                has_authority = auth_gensokyo
			}
		}
		modifier = {
			planet_pop_assembly_organic_add = 2
		}
		mult = planet.value:planet_genso_cloner_modifier
	}
}
building_spth_construction_bureau = {
	base_buildtime = 360
	can_build = yes
	category = government
	icon = building_chamber_of_elevation_1
	potential = {
		owner = {
			has_authority = auth_gensokyo
		}
		owner = { is_ai = no }
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = 600
		}
		cost = {
			trigger = {
				owner = { is_ai = no }
			}
			sr_lingli = 50
		}
		upkeep = {
			energy = 2
		}
	}

	triggered_planet_modifier = {
		modifier = {
			planet_barrier_capacity_use = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_ai = no
				is_regular_empire = yes
				has_authority = auth_gensokyo
			}
		}
		modifier = {
			job_genso_construction_worker_add = 1
		}
	}
}

building_spth_entertainment_forum = {
	base_buildtime = 360
	can_build = yes
	category = amenity
	icon = building_commercial_forum
	potential = {
		owner = {
			has_authority = auth_gensokyo
		}
		owner = { is_ai = no }
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = 600
		}
		cost = {
			trigger = {
				owner = { is_ai = no }
			}
			sr_lingli = 50
		}
		upkeep = {
			energy = 2
		}
	}

	triggered_planet_modifier = {
		modifier = {
			planet_barrier_capacity_use = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_ai = no
				is_regular_empire = yes
				has_authority = auth_gensokyo
			}
		}
		modifier = {
			job_genso_entertainer_add = 1
		}
	}
}

building_spth_clinic = {
	base_buildtime = 360
	can_build = yes
	category = amenity
	icon = building_ancient_relics
	potential = {
		owner = {
			has_authority = auth_gensokyo
		}
		owner = { is_ai = no }
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = 600
		}
		cost = {
			trigger = {
				owner = { is_ai = no }
			}
			sr_lingli = 50
		}
		upkeep = {
			energy = 2
		}
	}

	triggered_planet_modifier = {
		modifier = {
			planet_barrier_capacity_use = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_ai = no
				is_regular_empire = yes
				has_authority = auth_gensokyo
			}
		}
		modifier = {
			job_genso_healthcare_add = 1
		}
	}
}

building_spth_police_station = {
	base_buildtime = 360
	can_build = yes
	category = government
	icon = building_military_academy
	potential = {
		owner = {
			has_authority = auth_gensokyo
		}
		owner = { is_ai = no }
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = 600
		}
		cost = {
			trigger = {
				owner = { is_ai = no }
			}
			sr_lingli = 50
		}
		upkeep = {
			energy = 2
		}
	}

	triggered_planet_modifier = {
		modifier = {
			planet_barrier_capacity_use = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_ai = no
				is_regular_empire = yes
				has_authority = auth_gensokyo
			}
		}
		modifier = {
			job_genso_enforcer_add = 1
		}
	}

	triggered_country_modifier = {
		country_naval_cap_add = 4
		mult = value:spth_police_station_factor
	}
}

building_spth_stronghold = {
	base_buildtime = 360
	can_build = yes
	category = army
	icon = holding_park_ranger_lodge
	potential = {
		owner = {
			has_authority = auth_gensokyo
		}
		owner = { is_ai = no }
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = 600
		}
		cost = {
			trigger = {
				owner = { is_ai = no }
			}
			sr_lingli = 50
		}
		upkeep = {
			energy = 2
		}
	}

	triggered_planet_modifier = {
		modifier = {
			planet_barrier_capacity_use = 1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_ai = no
				is_regular_empire = yes
				has_authority = auth_gensokyo
			}
		}
		modifier = {
			job_genso_soldier_add = 1
		}
	}
}

building_spth_barrier_manager = {
	base_buildtime = @b4_time
	capital = no
	can_build = yes
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 1
	base_cap_amount = 0
	icon = building_production_center
	category = government
	upgrades = {
		building_spth_hakurei_shrine
		building_spth_moriya_shrine
		building_spth_kappa_labor_union
		building_spth_eientei
	}

	potential = {
		exists = owner
		owner = {
			has_authority = auth_gensokyo
		}
		owner = { is_ai = no }
		NOT = {
			has_building = building_spth_hakurei_shrine
			has_building = building_spth_moriya_shrine
			has_building = building_spth_kappa_labor_union
			has_building = building_spth_eientei
		}
	}

	allow = {
		num_pops >= 40
		# NOT = { has_building = building_spth_barrier_manager }
		NOT = {
			has_building = building_spth_hakurei_shrine
			has_building = building_spth_moriya_shrine
			has_building = building_spth_kappa_labor_union
			has_building = building_spth_eientei
		}
	}

	planet_modifier = {
		planet_housing_add = 20
		planet_amenities_add = 20
		planet_jobs_produces_mult = 0.1
		planet_barrier_capacity_use = 0.5
		planet_barrier_capacity_add = 1.0
		job_miko_add = 1
		job_miko_per_pop = 0.02
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			is_capital = yes
		}
		modifier = {
			job_miko_add = 1
			planet_jobs_produces_mult = 0.25
			planet_barrier_capacity_add = 1.0
			job_miko_per_pop = 0.005
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			OR = {
				is_planet_class = pc_ringworld_th
				is_planet_class = pc_gensokyo_city
				is_planet_class = pc_gensokyo_planet
			}
		}
		modifier = {
			job_miko_add = 1
			planet_jobs_produces_mult = 0.1
			planet_barrier_capacity_add = 0.5
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = 1200
		}
		cost = {
			trigger = {
				owner = { is_ai = no }
			}
			sr_lingli = 495
		}
		upkeep = {
			energy = 10
			sr_lingli = 4
			sr_fuka = 2
		}
	}
}

building_spth_kamikakushi_planet_terraformer = {
	base_buildtime = 1440
	can_build = yes
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 1
	icon = building_gaiaseeders_4
	category = army
	potential = {
		exists = owner
		owner = {
			has_authority = auth_gensokyo
			is_ai = no
		}
		is_planet_class = pc_kamikakushi_planet
	}
	allow = {
		exists = owner
		owner = {
			has_authority = auth_gensokyo
			is_ai = no
		}
		is_planet_class = pc_kamikakushi_planet
	}
	planet_modifier = {
		planet_housing_add = 20
		planet_amenities_add = 20
		pc_kamikakushi_planet_habitability = 10
		job_soldier_add = 5
	}
	resources = {
		category = planet_buildings
		cost = {
			minerals = 1200
			sr_lingli = 495
		}
		upkeep = {
			energy = 10
			sr_lingli = 4
			sr_fuka = 2
		}
	}
}
building_spth_lunar_databank = {
	base_buildtime = 0
	can_build = no
	can_be_ruined = no
	can_be_disabled = no
	can_demolish = no
	position_priority = 1
	icon = building_residence
	category = research
	planet_modifier = {
		planet_jobs_physics_research_produces_mult = 0.64
		planet_jobs_society_research_produces_mult = 0.64
		planet_jobs_engineering_research_produces_mult = 0.64
		job_researcher_add = 4
		job_head_researcher_add = 1
	}
	country_modifier = {
		category_archaeostudies_research_speed_mult = 0.2
	}
	resources = {
		category = planet_jobs
		cost = {
			minerals = 1
			sr_lingli = 1
		}
		produces = {
			physics_research = 4
			society_research = 4
			engineering_research = 4
		}
		produces = {
			physics_research = 12
			society_research = 12
			engineering_research = 12
			trigger = {
				owner = { has_ascension_perk = ap_toho4 }
			}
		}
		upkeep = {
			energy = 4
		}
	}
}
building_spth_torifune_shrine = {
	base_buildtime = 0
	can_build = no
	can_be_ruined = no
	can_be_disabled = no
	can_demolish = no
	position_priority = 1
	icon = building_suwa
	category = government
	planet_modifier = {
		planet_housing_add = 10
		planet_amenities_add = 10
		planet_barrier_capacity_use = 1
		planet_barrier_capacity_add = 0.5
	}
	triggered_planet_modifier = {
		job_miko_add = 2
		planet_housing_add = 30
		planet_amenities_add = 30
		# 完成遗址
		potential = {
			has_deposit = d_spth_torifune_control_centre
		}
	}
	country_modifier = {
		ship_speed_mult = 0.1
		all_technology_research_speed = 0.1
		ship_evasion_add = 1.5
	}
	triggered_country_modifier = {
		ship_speed_mult = 0.1
		ship_windup_mult = -0.2
		ship_evasion_add = 1.5
		# 发现遗址
		potential = { has_planet_flag = has_unlock_torifune_arc }
	}
	triggered_country_modifier = {
		all_technology_research_speed = 0.15
		ship_jumpdrive_cooldown_mult = -0.2
		ship_ftl_jumpdrive_range_mult = 1.0
		# 完成遗址
		potential = { has_deposit = d_spth_torifune_control_centre }
	}
	resources = {
		category = planet_jobs
		cost = {
			minerals = 1
			sr_lingli = 1
		}
		produces = {
			society_research = 2
			consumer_goods = 2
			multiplier = trigger:num_pops
		}
		produces = {
			consumer_goods = 2
			society_research = 2
			multiplier = trigger:num_pops
			# 完成遗址
			trigger = { has_deposit = d_spth_torifune_control_centre }
		}
		produces = {
			society_research = 4
			consumer_goods = 4
			multiplier = trigger:num_pops
			trigger = {
				owner = { has_ascension_perk = ap_toho4 }
			}
		}
		upkeep = {
			sr_lingli = 4
			multiplier = trigger:num_pops
		}
	}
}
building_spth_housing = {
	base_buildtime = 560
	can_build = yes
	category = amenity
	icon = building_fe_entertainment_2
	position_priority = 3
	potential = {
		owner = {
			has_authority = auth_gensokyo
		}
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = 900
		}
		cost = {
			trigger = {
				owner = { is_ai = no }
			}
			sr_lingli = 90
		}
		upkeep = {
			energy = 2
			sr_lingli = 1
		}
	}

	planet_modifier = {
		planet_housing_add = 16
		planet_amenities_add = 8
	}
	triggered_planet_modifier = {
		planet_housing_add = 4
		planet_amenities_add = 4
		multiplier = planet.planet_genso_job_buff_modifier
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_ai = no
				is_regular_empire = yes
				has_authority = auth_gensokyo
				has_ascension_perk = ap_toho3
			}
		}
		modifier = {
			planet_housing_add = 8
			planet_amenities_add = 8
		}
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_ai = no
				is_regular_empire = yes
				has_authority = auth_gensokyo
				has_ascension_perk = ap_toho3
			}
		}
		planet_housing_add = 8
		planet_amenities_add = 8
		multiplier = planet.planet_genso_job_buff_modifier
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_ai = no
				is_regular_empire = yes
				has_authority = auth_gensokyo
				has_ascension_perk = ap_toho4
			}
		}
		modifier = {
			planet_housing_add = 4
			planet_amenities_add = 4
		}
	}
	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				is_ai = no
				is_regular_empire = yes
				has_authority = auth_gensokyo
				has_ascension_perk = ap_toho4
			}
		}
		planet_housing_add = 10
		planet_amenities_add = 8
		multiplier = planet.planet_genso_job_buff_modifier
	}
}

# 首府建筑
building_spth_old_shirne = {
	base_buildtime = @b4_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0
	icon = building_bl
	category = government

	potential = {
		exists = owner
		owner = {
			is_regular_empire = yes
			has_authority = auth_gensokyo

		}
		NOR = {
			has_modifier = resort_colony
			has_modifier = slave_colony
		}
	}

	convert_to = {
		building_hive_major_capital
		building_machine_major_capital
		building_major_capital
		building_resort_major_capital
		building_slave_major_capital
		building_ancient_control_center
		building_ancient_palace
		building_system_capital_nanotech
	}

	allow = {
		always = no
	}

	planet_modifier = {
		job_miko_add = 1
		job_politician_add = 5
		planet_housing_add = 48
		planet_amenities_add = 24
		planet_stability_add = 12
		planet_jobs_productive_produces_mult = 0.9
		planet_max_buildings_add = 12
		planet_max_branch_office_buildings_add = 4
		defense_armies_add = 20
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_2 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_3 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.1
			planet_jobs_productive_produces_mult = 0.1
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner.federation
			owner.federation = { has_federation_perk = culture_workers_1 }
		}
		job_culture_worker_add = 2
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b4_minerals
		}
		upkeep = {
			energy = @b4_upkeep
			sr_lingli = 1
		}
	}

	triggered_desc = {
		trigger = {
			exists = owner.federation
			owner.federation = { has_federation_perk = culture_workers_1 }
		}
		text = job_culture_worker_effect_desc
	}

	triggered_desc = {
		trigger = {
			has_modifier = payback_unified_purpose
		}
		text = job_unifier_effect_desc
	}

	upgrades = {
		building_spth_planet_shirne
	}
}
building_spth_planet_shirne = {
	base_buildtime = @b4_time
	capital = yes
	can_build = no
	can_demolish = no
	can_be_ruined = no
	can_be_disabled = no
	position_priority = 0
	icon = building_bl
	category = government
	destroy_trigger = { always = no }

	potential = {
		exists = owner
		owner = {
			is_regular_empire = yes
			OR = {
				has_country_flag = spth_story_lunar_outpost
				has_authority = auth_gensokyo
			}
		}
		NOR = {
			has_modifier = resort_colony
			has_modifier = slave_colony
		}
	}

	convert_to = {
		building_hive_major_capital
		building_machine_major_capital
		building_major_capital
		building_resort_major_capital
		building_slave_major_capital
		building_ancient_control_center
		building_ancient_palace
		building_system_capital_nanotech
	}

	allow = {
		has_building = building_spth_old_shirne
		num_pops >= 75
	}

	planet_modifier = {
		job_miko_add = 1
		job_politician_add = 6
		planet_housing_add = 64
		planet_amenities_add = 32
		planet_stability_add = 16
		planet_jobs_productive_produces_mult = 0.9
		planet_max_buildings_add = 24
		planet_max_branch_office_buildings_add = 4
		defense_armies_add = 24
		job_spth_story_chief_researcher_per_pop = 0.05
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 10
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = {
				has_active_tradition = tr_domination_imperious_architecture
			}
		}
		modifier = {
			planet_housing_add = 10
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_1 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.2
			planet_jobs_productive_produces_mult = 0.2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_2 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.2
			planet_jobs_productive_produces_mult = 0.2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner
			owner = { has_technology = tech_capital_productivity_3 }
		}
		modifier = {
			planet_jobs_productive_upkeep_mult = 0.2
			planet_jobs_productive_produces_mult = 0.2
		}
	}

	triggered_planet_modifier = {
		potential = {
			exists = owner.federation
			owner.federation = { has_federation_perk = culture_workers_1 }
		}
		job_culture_worker_add = 2
	}

	resources = {
		category = planet_buildings
		cost = {
			minerals = @b4_minerals
		}
		upkeep = {
			energy = @b4_upkeep
			sr_lingli = 1
		}
	}

	triggered_desc = {
		trigger = {
			exists = owner.federation
			owner.federation = { has_federation_perk = culture_workers_1 }
		}
		text = job_culture_worker_effect_desc
	}

	triggered_desc = {
		trigger = {
			has_modifier = payback_unified_purpose
		}
		text = job_unifier_effect_desc
	}

	upgrades = {
	}
}
